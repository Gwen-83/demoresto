<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Paiement</title>
  <script>
    const token = localStorage.getItem('token');
    const cart = JSON.parse(localStorage.getItem('cart'));

    if (!token || !cart || cart.length === 0) {
      // Redirection AVANT chargement de la page
      window.location.href = "panier.html?error=unauthorized";
    }
  </script>
  <link rel="stylesheet" href="style.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Raleway&display=swap" rel="stylesheet">
</head>
<body>
  <div id="notification" class="notification hidden">
  <p id="notification-message"></p>
  <button class="close-btn" onclick="hideNotification()">×</button>
</div>
<header>
  <h1>Chez Mario</h1>
  <button class="menu-toggle" aria-label="Ouvrir le menu">&#9776;</button>
  <nav>
    <div class="nav-left">
      <a href="index.html">Accueil</a>
      <a href="menu.html">Menu</a>
      <a href="reservation.html">Réservation</a>
      <a href="contact.html">Contact</a>
      <a href="panier.html">Voir le panier</a>
      <a href="admin.html" id="admin-link" style="display: none;">Administration</a>
    </div>
    <div id="user-status"></div>
  </nav>
</header>

<section class="order-summary">
  <h2 class="title-payment">Résumé de votre commande</h2>
  <table>
    <thead>
      <tr>
        <th>Produit</th>
        <th>Quantité</th>
        <th>Total</th>
      </tr>
    </thead>
    <tbody id="payment-summary-body"></tbody>
  </table>
  <h3 id="payment-total">Total : 0.00€</h3>
</section>

<section class="payment-method">
  <h2>Moyen de paiement</h2>
  <p>Ce site est une version Démo. Aucune transaction réelle ne sera effectuée. Si vous souhaitez tester, utilisez la carte "4242 4242 4242 4242" avec n'importe quel date dans le futur et n'importe quel CVC. Vous allez etre redirigé vers Stripe en cliquant ci-dessous.</p>
  <button onclick="simulatePayment()">Payer maintenant</button>
</section>
<script src="https://js.stripe.com/v3/"></script>
<footer>
  <div class="footer-logo">
    <img src="public/logo.png" alt="Logo Chez Mario">
  </div>
  <div class="footer-infos">
    <p>Chez Mario <span class="sep">|</span> 12 Rue des Oliviers, 66000 Perpignan <span class="sep">|</span> 04 68 12 34 56 <span class="sep">|</span> email: contact@chezmario.fr</p>
  </div>
  <div class="footer-credit">
    <p>Réalisation : GD</p>
  </div>
  <div class="footer-map">
    <a href="https://www.google.com/maps/place/12+Rue+des+Oliviers,+66000+Perpignan" target="_blank" class="map-button">Plan d'accès</a>
  </div>
</footer>
</body>
</html>